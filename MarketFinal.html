<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purwadhika Mart</title>
</head>
<body>
    <script>
        // *************** DATA MARKET ***************
        let products = [
            {nama : 'Apel', stock : 10, harga : 10000},
            {nama : 'Jeruk', stock : 15, harga : 15000},
            {nama : 'Anggur', stock : 20, harga : 20000}
        ]

        let addToCart = []

        // *************** FUNCTION MARKET ***************
        function showDataProducts(){
            let printDataProduct = 'PRODUCT MARKET : \n'
            
            for(let i = 0; i < products.length; i++){
                printDataProduct += `${i+1}. ${products[i].nama} Memiliki Stock ${products[i].stock}Kg (Rp. ${products[i].harga}/Kg) \n`
            }

            return printDataProduct
        }

        function showDataCart(){
            let printDataCart = 'USERS CART :  \n'

            for(let i = 0; i < addToCart.length; i++){
                printDataCart += `${i+1}. ${addToCart[i].nama} : ${addToCart[i].harga} x ${addToCart[i].qty}Kg`
            }

            return printDataCart
        }

        // *************** MAIN PROGRAM ***************
        let loginAs
        do{
            loginAs = Number(prompt(`1. Kasir \n 2. Customer \n 3. Exit`))
            if(loginAs == 1){
                // *************** MENU KASIR ***************
                let menuKasir
                do{
                    menuKasir = Number(prompt(`MENU KASIR \n 1. Lihat Product \n 2. Tambah Product \n 3. Delete Product \n 4. Kembali`))

                    if(menuKasir == 1){
// 1. *************** LIHAT PRODUCT
                        alert(showDataProducts())
                    }else if(menuKasir == 2){
// 2. *************** TAMBAH PRODUCT
                        let checkValidasi = false
                        let promptInputProduct
                        while(checkValidasi == false){
                            promptInputProduct = prompt(`Masukan Nama Product`)

                            let productSudahAda = false 
                            for(let i=0; i < products.length; i++){
                                if(products[i].nama == promptInputProduct){
                                    productSudahAda = true
                                }
                            }

                            if(productSudahAda == true){
                                alert('Product Sudah Ada')
                            }else{
                                if(promptInputProduct >= 0 || promptInputProduct < 0){ 
                                    // Jika Inputan Kasir Salah (123)
                                    checkValidasi = false
                                }else{ // Jika Inputan Kasir Benar (ABC)
                                    checkValidasi = true
                                }
                            }
                        }
                        
                        let promptInputStock
                        while(checkValidasi == true){
                            promptInputStock = prompt(`Masukan Stock Product (Kg)`)

                            if(promptInputStock > 0){
                                // Jika Inputan Kasir Benar
                                checkValidasi = false
                            }else{
                                // Jika Inputan Kasir Salah
                                checkValidasi = true
                            }
                        }

                        let promptInputHarga
                        while(checkValidasi == false){
                            promptInputHarga = prompt(`Masukan Harga Product (Rp)`)

                            if(promptInputHarga > 0){
                                // Jika Inputan User Benar
                                checkValidasi = true
                            }else{
                                // Jika Inputan Kasir Salah
                                checkValidasi = false
                            }
                        }

                        products.push({nama : promptInputProduct, stock : promptInputStock, harga : promptInputHarga})
                    }else if(menuKasir == 3){
// 3. *************** DELETE PRODUCT
                        let checkValidasi = false
                        let deleteProductSelected

                        while(checkValidasi == false){
                            deleteProductSelected = prompt(`${showDataProducts()} \n Mau Delete Product Nomor Berapa?`)
                        
                            if(deleteProductSelected > 0){ 
                                if(deleteProductSelected-1 < products.length){
                                    products.splice(deleteProductSelected-1, 1)
                                    alert('Product Berhasil Dihapus!')
                                    checkValidasi = true
                                }
                            }
                        }
                    }
                }while(menuKasir != 4)
                
                
                
            }else if(loginAs == 2){
                // *************** MENU CUSTOMER ***************
                let menuCustomer

                do{
                    menuCustomer = prompt(`
                        MENU CUSTOMER \n 
                        ------------- \n
                        Keranjang Belanja Anda : ${addToCart.length} \n
                        ${showDataCart()} \n
                        1. Add To Cart \n 2. Checkout \n 3. Kembali
                    `)

                    if(menuCustomer == 1){
// 1. *************** ADD TO CART
                        let checkValidasi = false
                        let promptProductCustomer
                        while(checkValidasi == false){
                            promptProductCustomer = prompt(`${showDataProducts()} \n Masukan Product Kedalam Cart :`)

                            if(promptProductCustomer > 0){
                                if(promptProductCustomer-1 < products.length){
                                    checkValidasi = true
                                }
                            }
                        }

                        let promptQtyCustomer
                        while(checkValidasi == true){
                            promptQtyCustomer = prompt('Masukan Quantity (Kg) :')
                            
                            if(promptQtyCustomer > 0){
                                if(promptQtyCustomer > products[promptProductCustomer-1].stock){
                                    alert(`Qty Melebihi Stock! Stock Hanya ${products[promptProductCustomer-1].stock}Kg`)
                                    checkValidasi = true
                                }else{
                                    checkValidasi = false
                                }
                            }
                        }

                        addToCart.push({nama : products[promptProductCustomer-1].nama, qty : promptQtyCustomer, harga : products[promptProductCustomer-1].harga})
                    }else if(menuCustomer == 2 && addToCart.length > 0){
// 2. *************** CHECKOUT
                        let grandTotal = 0

                        for(let i=0; i < addToCart.length; i++){
                            grandTotal += addToCart[i].harga * addToCart[i].qty
                        }

                        // addToCart.forEach((value, index) => grandTotal += value.harga * value.qty) 

                        checkValidasi = false
                        while(checkValidasi == false){
                            let uangCustomer = prompt(`
                                KERANJANG BELANJA ANDA \n
                                ---------------------- \n
                                ${showDataCart()} \n
                                ---------------------- \n
                                Total Belanja Anda : ${grandTotal} \n
                                Masukan Uang Anda :
                            `)

                            if(uangCustomer < grandTotal){
                                alert('Uang Anda Kurang!')
                            }else{
                                checkValidasi = true
                            }
                        }

                        alert(`Pesanan Anda Segera Kami Proses!`)
                        addToCart = []
                    }
                }while(menuCustomer != 3)
            }else if(loginAs == 3){
                alert('Thanks For Using Us')
            }
        }while(loginAs != 3)
    </script>
</body>
</html>